{"version":3,"sources":["node_modules/browser-pack/_prelude.js","_scripts/filters.js","_scripts/js/filters.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","filterload","initFilter","document","readyState","addEventListener","once","packaged","submitFilters","form","formvalues","pillvalues","inclusive","fdata","FormData","formstring","URLSearchParams","toString","selarray","counter","obj1","obj2","incConditions","exclConditions","exclude","idarray","sessionStorage","setItem","$","addClass","class","forEach","value","key","mykey","includes","push","Reflect","has","Array","isArray","append","makePill","formobject","Object","entries","clearSearch","fromEntries","filter","k","search","keys","every","arr","some","v","include","flatMap","el","keeps","ref","removeClass","filterCounts","div","getElementById","divid","classList","remove","add","myfilters","filters","empty","loadFilters","clear","val","savedData","getItem","input","elements","id","type","checked","RadioNodeList","rlength","location","reload","num","word","attr","html","classCount","componentCount","querySelectorAll","vText","mypill","keyID","title","text","bind","removeFilter","me","let","ent","this","myform","reset","baseURL","clearsearchbutton","window","origin","ajax","url","data","get_param","dataType","success","error","console","log","preventDefault","prop","click","sectfilter","togs","on","fetched","selectedO","selectV","confirmer","match","tog","togv","toggleClass"],"mappings":"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","file":"filters.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","const filterload = require(\"./js/filters\");\n\nconst initFilter = () => {\n  filterload();\n};\n\nif (document.readyState === \"loading\") {\n  document.addEventListener(\"DOMContentLoaded\", initFilter, { once: true });\n} else {\n    initFilter();\n}","// load workbook data\nvar packaged = [];\n\n// saves filter state and calls sorting function\nfunction submitFilters(form){\n  // get form data\n  var fdata = new FormData(form);\n  var formstring = new URLSearchParams(fdata).toString();\n\n  // store filters\n  sessionStorage.setItem('sciwbLastsearch', formstring);\n  sortForm(fdata); \n\n  // do not reload\n  return false;\n  \n}\n\n// loads filters from session storage\nfunction loadFilters(form, clear = \"nope\"){\n// get form data\nvar savedData = sessionStorage.getItem('sciwbLastsearch'),\n    fdata = (new URLSearchParams(savedData)).entries();\n//set clear as key, value pair to remove from URLParams, then resubmit form\n\n// loop through saved session information\nfillForm(fdata, form, clear);\n\n// submit loaded form\nsubmitFilters(form);\n}\n\nfunction fillForm(filldata, form, clear){\n    for(const [ key, val ] of filldata) {\n        if(key === clear[ 0 ] && val === clear[ 1 ]){\n          // skip filter\n        } else {\n          if( !(val === \"\") ){\n          const input = form.elements[ key ];\n          if( input.id === key){\n            // set checkbox\n              switch(input.type) {\n                case 'checkbox': input.checked = !!val; \n                default:         input.value = val;     \n              }       \n          } else if (input instanceof RadioNodeList) {\n            // set radio button\n              rlength = input.length;\n              for (var i = 0; i < rlength; i++) {\n                if(input[ i ].value === val){\n                  input[ i ].checked = !!val;\n                 }\n              }\n            } \n        } }\n      }\n}\n\nfunction sortForm(fdata){\n\n$(\"#nowbs\").addClass('no-display');\n// hide No Results Found message if showing\n\nvar formvalues = [ ]; // form values in object format\nvar pillvalues = $(\"<ul/>\", { 'class':\"filter-pills__list\" });\nvar inclusive = [ ]; // keys that have 'inclusive' data handling\nfdata.forEach((value, key) => {\n  if (value !== \"\") {\n    if(key.includes(\"inclusive\")){\n      inclusive.push(value);\n    } else if (!(key.includes(\"selector\"))){\n      var mykey = '';\n      if(key=='subject'){\n        mykey = 'subject';\n        inclusive.push(value);\n      } else {\n        mykey = key; \n      }\n      // Add pill for new filter value\n      if(!Reflect.has(formvalues, mykey)){\n        pillvalues.append(makePill(key,value));\n        formvalues[ mykey ] = value;\n        return;\n      }\n      if(!Array.isArray(formvalues[ mykey ])){\n        formvalues[ mykey ] = [ formvalues[ mykey ] ];    \n      }\n      pillvalues.append(makePill(key,value));\n      \n      formvalues[ mykey ].push(value);\n    }\n  }\n    \n});\n\nvar formobject = Object.entries(formvalues);\n\n// If no filters, clear search; otherwise, filter workbooks\nif(formobject.length === 0){\n  clearSearch();\n} else {\n  filterWBs(formobject, inclusive);\n  displayfilters(pillvalues);\n}\n\n\n}\n\n// clears all filters and reloads page\nfunction clearSearch(){\nsessionStorage.clear();\n// Refresh the page\nlocation.reload();\n\n}\n\n\nfunction filterWBs(formobject, inclusive){\n// Split filters into inclusive and exclusive\n  var obj1 = Object.fromEntries(formobject.filter(([ k ]) => inclusive.includes(k)));\n  var obj2 = Object.fromEntries(formobject.filter(([ k ]) => !inclusive.includes(k)));\n\n// Helper functions for inclusive/exclusive matching\n  var c_exclusive = (arr, target) => target.every(v => arr.includes(v));\n  var c_inclusive = (arr, target) => target.some(v => arr.includes(v));\n// Build filter conditions\n  var incConditions = search => a => Object.keys(search).every(k => \n    (Array.isArray(search[ k ]) && ((Array.isArray(a[ k ]) && c_inclusive(a[ k ], search[ k ])) || search[ k ].includes(a[ k ]) )) ||\n    a[ k ] === search[ k ] ||\n    Array.isArray(a[ k ]) && a[ k ].includes(search[ k ])\n  ),\n  exclConditions = search => a => Object.keys(search).every(k => \n    (Array.isArray(search[ k ]) && ((Array.isArray(a[ k ]) && c_exclusive(a[ k ], search[ k ])) || search[ k ].includes(a[ k ]) ))||\n    a[ k ] === search[ k ] ||\n    Array.isArray(a[ k ]) && a[ k ].includes(search[ k ])\n  );\n// Filter packaged data\n  var exclude = {};\n  if(Object.keys(obj1).length===0){\n    exclude = packaged.filter(exclConditions(obj2));\n  } else {\n    // filter by inclusive conditions\n    var include = packaged.filter(incConditions(obj1));\n    // filter by exclusive conditions\n    exclude = include.filter(exclConditions(obj2));\n}\n\n  // get ids of items that match the selected tutorials\n  var idarray = exclude.flatMap(function (el) { return el.keeps; });\n  var selarray = exclude.flatMap(function (el) { return el.ref; });\n  checkWBs(idarray,selarray);\n}\n\n// check for matches\nfunction checkWBs(idarray,selarray){\n\n  // display error message if no workbooks found\n  if(idarray.length===0){\n    noWBsFound();\n  } else {\n    showWBs(idarray,selarray);\n  }\n  \n}\n\n// show \"no results\" if no matches found\nfunction noWBsFound(){\n$(\".wb\").addClass('no-display').removeClass('wb-select');\n$(\"#search-placeholder\").removeClass('no-display');\n\nfilterCounts(0);\n}\n\nfunction showWBs(idarray,selarray){\n\n// hide all tutorials\n$(\".wb\").addClass('no-display').removeClass('wb-select');\n$(\"#search-placeholder\").removeClass('no-display');\n\n// display only selected tutorials\nvar counter=0;\nidarray.forEach((divid) =>{\n  var div = document.getElementById(divid);\n  if(div) {\n    div.classList.remove('no-display');\n    if (selarray.includes(divid)){\n      div.classList.add('wb-select');\n      counter=counter+1;\n    }\n  }\n});\n\nfilterCounts(counter);\n\n}\n\n// Updates the count of filtered workbooks\nfunction filterCounts(num){\nvar div = $(\"#component-count\");\nif (div.attr(\"path\") == \"json\"){\n  jsonCount(div, num);\n} else {\n  classCount(div);\n}\n}\n\n// \nfunction jsonCount(div, num){\n  var word = (num === 1) ? \"workbook\" : \"workbooks\";\n  div.html(`<strong>${num}</strong> ${word} found`);\n}\n\nfunction classCount(div){\ncomponentCount = document.querySelectorAll('.fc:not(.fc-no-display):not(.no-display)').length;\nvar word = (componentCount === 1) ? \"workbook\" : \"workbooks\";\ndiv.html(`<strong>${componentCount}</strong> ${word} found`);\n}\n  \n\nfunction displayfilters(myfilters){\nvar filters = $('#filter-pills');\nfilters.empty();\nfilters.append(myfilters);\n} \n\nfunction makePill(k,v){\n//var pSet = \"filter-pill-\" + k + \"-\" + v;\n//var pID = pSet.replace(/ /g, \"-\");\nvar vText = v;\n\nvar mypill = $(\"<li/>\", {\n  \"class\": \"filter-pills__item\",\n  \"keyID\": k,\n  \"value\": v,\n}).append($('<a/>',{\n  \"class\": \"filter-pills__pill\",\n  \"title\": vText,\n}).append($(\"<span/>\", {\n  \"class\":\"filter-pill-name\",\n  text: vText,\n})).append($(\"<span/>\", {\n  \"class\":\"filter-pills__remove\",\n}).html(\n  '<span class=\"filter-pills__remove\">' +\n    '<svg class=\"usa-icon\" aria-hidden=\"true\" focusable=\"false\" role=\"img\">'+\n      '<use xlink:href=\"/assets/uswds/img/sprite.svg#close\"></use>'+\n    '</svg>' +\n  '</span>'\n  )));\n\n// Bind click to remove filter\nmypill.bind('click', function() {\n  removeFilter(this);\n});\nreturn mypill;\n\n}\n\n// Removes a filter pill\nfunction removeFilter(me){\nlet ent = $(me),\n    k = ent.attr(\"keyID\"),\n    v = ent.attr(\"value\");\nvar myform = document.getElementById(\"workbook-array\");\nmyform.reset();\nloadFilters(myform, [ k,v ]);\n}\n\n// Returns the \"workbook\" array from workbookdata\nfunction getWorkbooks(myform) {  \n    const baseURL = window.location.origin;\n    $.ajax({\n        type: 'GET',\n        url: baseURL + '/assets/js/filter/workbooks.json',\n        data: { get_param: 'value' },\n        dataType: 'json',\n        success: function (data) {\n          packaged = data;\n\n          // Load filters from session storage if present\n          if ('sciwbLastsearch' in sessionStorage) {\n            loadFilters(myform);\n          } else { \n            classCount($(\"#component-count\")); \n          }\n        },\n        error: function () {\n          console.log(\"Failed to fetch workbook filter data\");\n        },\n    });\n}\n\nfunction filterload() {\n  \n  var myform = document.getElementById(\"workbook-array\"),\n    clearsearchbutton = document.getElementById(\"clearsearch\");\n    getWorkbooks(myform);\n\n  // add submitFilters function to form\n  myform.addEventListener(\"submit\", function (e) {\n    e.preventDefault();\n    submitFilters(this); \n    });\n  clearsearchbutton.addEventListener(\"click\", function(){\n        clearSearch();\n    });\n      // Toggle all checkboxes in a section to enable the Select All option\n       $('.filter-toggle').prop(\"checked\", false).click(function() {\n  \n          let sectfilter = $(this).attr(\"toggles\"),\n              togs = $(this);\n          \n          if(togs.prop(\"checked\")){\n              togs.text('Select All');\n          } else { togs.text('Deselect All'); }\n  \n          togs.prop(\"checked\", !togs.prop(\"checked\"));\n          $('.'+sectfilter).prop('checked', this.checked);                \n      }); \n  // Handle select-multiple dropdowns with confirmation\n      $('.selectmultiple').on('change', function () {\n        let selectedO = $(\"option:selected\", this),\n          selectV = this.value;\n  \n        if (selectV) {\n          let confirmer = selectedO.attr( \"confirms\" ),\n            match = selectedO.attr( \"match\" );\n  \n          var fetched = myform.elements[ confirmer ];\n  \n          if(fetched[ match ].value === selectV){\n            fetched[ match ].checked = !!selectV;\n          }      \n        }\n      });\n// Toggle inclusive/exclusive filter mode\n      $('.inclusive-toggle').prop(\"checked\", false).click(function() {\n        let tog = $(this),\n            togv = $(\"#\"+tog.attr(\"value\")+\"-hint\");\n            \n        if(tog.prop(\"checked\")){\n          togv.text('Results match tag 1 OR tag 2');\n        } else { togv.text('Results match tag 1 AND tag 2'); }\n      });\n  \n      // Tooltip toggles\n      $('.tooltip-toggle').click(function(){\n        let tog = $(this).attr(\"toggles\");\n        $(\"#\"+tog).toggleClass( \"no-display\" );\n  \n      });\n}\n  \nmodule.exports = filterload;"]}